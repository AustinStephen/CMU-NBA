---
title: "Measuring and Predicting Player Fatigue in the NBA"
author: "<span style='font-size: 40px'>Austin Stephen, Matthew Yep and Grace Fain </style>"
date: "<span style='font-size: 36px'> 7/13/2021 </style>"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    
---
<style type="text/css">

h1.title {
  font-size: 10px;
}

</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

 
```

```{r xaringan-themer, include=FALSE, warning=FALSE }
library(xaringanthemer)
style_mono_accent(base_color = "#cc002c",
  white_color = "#e6e6e6",
  background_color = "#b3b3b3",
  base_font_size = "28px"
  )
```

## Why fatigue?
- Optimized Performance  

- Injury Prevention   

???
Add source that found as players get more tired performance worsens in basketball.
Add source that talks about injury links to fatigue 
Add a source that 

---

## The Plan

1. Measure player fatigue  
  
2. Build a model that can be used to predict the impact of fatigue on a given game or
multi-game sequence.


???
Identify a proxy for fatigue and link it to in game performance.
This model can used by teams to examine their roster and match-ups and gain insights into 
how differnt factors are influencing their teams performance

---

## Measuring player fatigue
- Cannot use direct measures
  
- Identify a proxy

???
NBA players cannot wear heart rate monitors or tracking equipment in games 

---

## Proxy for Fatigue
- In game distance
- Between game distance

???
We are examining two major sources for player fatigue.
1. The distance and speed at which they travel in game. 
2. The characteristics of their travel between games including days of rest,
distance traveled and time zone changes.

---

## The in-game data

???
Insert table showing how it is structured

---

## Progress with in-game data 

???
Go through progress with in game data

---

## Progress with in-game data 2

???
Go through progress with in game data

---
# GRACE ADD HERE 

```{r load in data, include=FALSE}
library(tidyverse)
library(dplyr)
library(nbastatR)
library(NBAr)
library(tidyr)
library(knitr)
density_drives_2014_15 <- read.csv("./data1/density_distance_drives_tracking/_density_drives_distance_daily_2014_15.csv")
```

```{r table, echo = FALSE}
density_drives_2014_15 %>%
  kable()
knitr::kable(head(density_drives_2014_15), format = 'html', table.attr = "style='height:20%;'")

```

```{r drives_pts_pct, echo=FALSE}
##ATL
b2b_2014_ATL <- density_drives_2014_15 %>%
  filter(B2B.2nd == "Yes") %>%
  filter(drives > 0) %>%
  group_by(player_id) %>%
  filter(team_abbreviation == "ATL")

other_2014_ATL <- density_drives_2014_15 %>%
  filter(B2B.2nd == "No") %>%
  filter(drives > 0) %>%
  group_by(player_id) %>%
  filter(team_abbreviation == "ATL")

notB2b_2014_ATL <- aggregate(other_2014_ATL$drive_pts_pct / nrow(other_2014_ATL), list(other_2014_ATL$player_name), FUN=sum, na.rm = TRUE)

B2b_2014_ATL <-aggregate(b2b_2014_ATL$drive_pts_pct / nrow(b2b_2014_ATL), list(b2b_2014_ATL$player_name), FUN=sum, na.rm = TRUE)

drive_pct_2014_ATL <- merge(B2b_2014_ATL, notB2b_2014_ATL, by = "Group.1") %>%
  rename("2nd_B2B_game" = x.x, "not_2nd_B2B" = x.y)

drive_2014_ATL_long <- drive_pct_2014_ATL %>%
  gather("Stat", "Value", -Group.1)

ggplot(drive_2014_ATL_long, aes(x = Group.1, y = Value, fill = Stat)) +
  geom_bar(stat = "Identity", position = "dodge") +
  theme_bw() +
  ggtitle("Atlanta Hawks") +
  xlab("Players") +
  ylab("avg drive_pts_percent")

## GSW
b2b_2014_GSW <- density_drives_2014_15 %>%
  filter(B2B.2nd == "Yes") %>%
  filter(drives > 0) %>%
  group_by(player_id) %>%
  filter(team_abbreviation == "GSW")

other_2014_GSW <- density_drives_2014_15 %>%
  filter(B2B.2nd == "No") %>%
  filter(drives > 0) %>%
  group_by(player_id) %>%
  filter(team_abbreviation == "GSW")

notB2b_2014_GSW <- aggregate(other_2014_GSW$drive_pts_pct / nrow(other_2014_GSW), list(other_2014_GSW$player_name), FUN=sum, na.rm = TRUE)

b2b_2014_GSW <-aggregate(b2b_2014_GSW$drive_pts_pct / nrow(b2b_2014_GSW), list(b2b_2014_GSW$player_name), FUN=sum, na.rm = TRUE)

drive_pct_2014_GSW <- merge(b2b_2014_GSW, notB2b_2014_GSW, by = "Group.1") %>%
  rename("2nd_B2B_game" = x.x, "not_2nd_B2B" = x.y)

drive_2014_GSW_long <- drive_pct_2014_GSW %>%
  gather("Stat", "Value", -Group.1)

ggplot(drive_2014_GSW_long, aes(x = Group.1, y = Value, fill = Stat)) +
  geom_bar(stat = "Identity", position = "dodge") +
  theme_bw() +
  ggtitle("Golden State Warriors") +
  xlab("Players") +
  ylab("avg drive_pts_percent")

##DAL
b2b_2014_DAL <- density_drives_2014_15 %>%
  filter(B2B.2nd == "Yes") %>%
  filter(drives > 0) %>%
  group_by(player_id) %>%
  filter(team_abbreviation == "DAL")

other_2014_DAL <- density_drives_2014_15 %>%
  filter(B2B.2nd == "No") %>%
  filter(drives > 0) %>%
  group_by(player_id) %>%
  filter(team_abbreviation == "DAL")

notB2b_2014_DAL <- aggregate(other_2014_DAL$drive_pts_pct / nrow(other_2014_DAL), list(other_2014_DAL$player_name), FUN=sum, na.rm = TRUE)

b2b_2014_DAL <-aggregate(b2b_2014_DAL$drive_pts_pct / nrow(b2b_2014_DAL), list(b2b_2014_DAL$player_name), FUN=sum, na.rm = TRUE)

drive_pct_2014_DAL <- merge(b2b_2014_DAL, notB2b_2014_DAL, by = "Group.1") %>%
  rename("2nd_B2B_game" = x.x, "not_2nd_B2B" = x.y)

drive_2014_DAL_long <- drive_pct_2014_DAL %>%
  gather("Stat", "Value", -Group.1)

ggplot(drive_2014_DAL_long, aes(x = Group.1, y = Value, fill = Stat)) +
  geom_bar(stat = "Identity", position = "dodge") +
  theme_bw() +
  ggtitle("Dallas Mavericks") +
  xlab("Players") +
  ylab("avg drive_pts_percent")

## CHI
b2b_2014_CHI <- density_drives_2014_15 %>%
  filter(B2B.2nd == "Yes") %>%
  filter(drives > 0) %>%
  group_by(player_id) %>%
  filter(team_abbreviation == "CHI")

other_2014_CHI <- density_drives_2014_15 %>%
  filter(B2B.2nd == "No") %>%
  filter(drives > 0) %>%
  group_by(player_id) %>%
  filter(team_abbreviation == "CHI")

notB2b_2014_CHI <- aggregate(other_2014_CHI$drive_pts_pct / nrow(other_2014_CHI), list(other_2014_CHI$player_name), FUN=sum, na.rm = TRUE)

b2b_2014_CHI <-aggregate(b2b_2014_CHI$drive_pts_pct / nrow(b2b_2014_CHI), list(b2b_2014_CHI$player_name), FUN=sum, na.rm = TRUE)

drive_pct_2014_CHI <- merge(b2b_2014_CHI, notB2b_2014_CHI, by = "Group.1") %>%
  rename("2nd_B2B_game" = x.x, "not_2nd_B2B" = x.y)

drive_2014_CHI_long <- drive_pct_2014_CHI %>%
  gather("Stat", "Value", -Group.1)

ggplot(drive_2014_CHI_long, aes(x = Group.1, y = Value, fill = Stat)) +
  geom_bar(stat = "Identity", position = "dodge") +
  theme_bw()  +
  ggtitle("Chicago Bulls") +
  xlab("Players") +
  ylab("avg drive_pts_percent")

```
---
# MATTHEW ADD HERE
Grace add your progress with between game data

