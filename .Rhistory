filter(team_abbreviation == "NYK")
other_2014_NYK <- density_drives_2014_15 %>%
filter(B2B.2nd == "No") %>%
filter(drives > 0) %>%
group_by(player_id) %>%
filter(team_abbreviation == "NYK")
notB2b_2014_NYK_pass <- aggregate((other_2014_NYK$drive_passes_pct) / nrow(other_2014_NYK), list(other_2014_NYK$player_name), FUN=sum, na.rm = TRUE)
b2b_2014_NYK_pass <-aggregate((b2b_2014_NYK$drive_passes_pct) / nrow(b2b_2014_NYK), list(b2b_2014_NYK$player_name), FUN=sum, na.rm = TRUE)
drive_pct_2014_NYK_pass <- merge(b2b_2014_NYK_pass, notB2b_2014_NYK_pass, by = "Group.1") %>%
rename("2nd_B2B_game" = x.x, "not_2nd_B2B" = x.y)
drive_2014_NYK_long_pass <- drive_pct_2014_NYK_pass %>%
gather("Stat", "Value", -Group.1)
p4 <- ggplot(drive_2014_NYK_long_pass, aes(x = Group.1, y = Value, fill = Stat)) +
geom_bar(stat = "Identity", position = "dodge") +
theme_bw()  +
ggtitle("New York Knicks") +
xlab("Players") +
ylab("avg drive_pts_percent") +
scale_fill_manual("Stat", values = c("not_2nd_B2B" = "black", "2nd_B2B_game" = "skyblue")) +
theme(axis.text.x = element_text(size=5, angle=45, hjust = 1))
grid.arrange(p2, p3, p1, p4, nrow = 2, ncol = 2)
density_drives_2018_19 <- read.csv("./data1/density_distance_drives_tracking/_density_drives_distance_daily_2018_19.csv")
##ATL
b2b_2018_ATL <- density_drives_2018_19 %>%
filter(B2B.2nd == "Yes") %>%
filter(drives > 0) %>%
group_by(player_id) %>%
filter(team_abbreviation == "ATL")
other_2018_ATL <- density_drives_2018_19 %>%
filter(B2B.2nd == "No") %>%
filter(drives > 0) %>%
group_by(player_id) %>%
filter(team_abbreviation == "ATL")
notB2b_2018_ATL_pass <- aggregate(other_2018_ATL$drive_passes_pct / nrow(other_2018_ATL), list(other_2018_ATL$player_name), FUN=sum, na.rm = TRUE)
B2b_2018_ATL_pass <-aggregate(b2b_2018_ATL$drive_passes_pct / nrow(b2b_2018_ATL), list(b2b_2018_ATL$player_name), FUN=sum, na.rm = TRUE)
drive_pct_2018_ATL_pass <- merge(B2b_2018_ATL_pass, notB2b_2018_ATL_pass, by = "Group.1") %>%
rename("2nd_B2B_game" = x.x, "not_2nd_B2B" = x.y)
drive_2018_ATL_long_pass <- drive_pct_2018_ATL_pass %>%
gather("Stat", "Value", -Group.1)
p1 <- ggplot(drive_2018_ATL_long_pass, aes(x = Group.1, y = Value, fill = Stat)) +
geom_bar(stat = "Identity", position = "dodge") +
theme_bw() +
ggtitle("Atlanta Hawks") +
xlab("Players") +
ylab("avg drive_pts_percent") +
scale_fill_manual("Stat", values = c("not_2nd_B2B" = "black", "2nd_B2B_game" = "skyblue")) +
theme(axis.text.x = element_text(size=5, angle=45, hjust = 1))
## GSW
b2b_2018_GSW <- density_drives_2018_19 %>%
filter(B2B.2nd == "Yes") %>%
filter(drives > 0) %>%
group_by(player_id) %>%
filter(team_abbreviation == "GSW")
other_2018_GSW <- density_drives_2018_19 %>%
filter(B2B.2nd == "No") %>%
filter(drives > 0) %>%
group_by(player_id) %>%
filter(team_abbreviation == "GSW")
notB2b_2018_GSW_pass <- aggregate(other_2018_GSW$drive_passes_pct / nrow(other_2018_GSW), list(other_2014_GSW$player_name), FUN=sum, na.rm = TRUE)
##ATL
b2b_2018_ATL <- density_drives_2018_19 %>%
filter(B2B.2nd == "Yes") %>%
filter(drives > 0) %>%
group_by(player_id) %>%
filter(team_abbreviation == "ATL")
other_2018_ATL <- density_drives_2018_19 %>%
filter(B2B.2nd == "No") %>%
filter(drives > 0) %>%
group_by(player_id) %>%
filter(team_abbreviation == "ATL")
notB2b_2018_ATL_pass <- aggregate(other_2018_ATL$drive_passes_pct / nrow(other_2018_ATL), list(other_2018_ATL$player_name), FUN=sum, na.rm = TRUE)
B2b_2018_ATL_pass <-aggregate(b2b_2018_ATL$drive_passes_pct / nrow(b2b_2018_ATL), list(b2b_2018_ATL$player_name), FUN=sum, na.rm = TRUE)
drive_pct_2018_ATL_pass <- merge(B2b_2018_ATL_pass, notB2b_2018_ATL_pass, by = "Group.1") %>%
rename("2nd_B2B_game" = x.x, "not_2nd_B2B" = x.y)
drive_2018_ATL_long_pass <- drive_pct_2018_ATL_pass %>%
gather("Stat", "Value", -Group.1)
p1 <- ggplot(drive_2018_ATL_long_pass, aes(x = Group.1, y = Value, fill = Stat)) +
geom_bar(stat = "Identity", position = "dodge") +
theme_bw() +
ggtitle("Atlanta Hawks") +
xlab("Players") +
ylab("avg drive_pts_percent") +
scale_fill_manual("Stat", values = c("not_2nd_B2B" = "black", "2nd_B2B_game" = "skyblue")) +
theme(axis.text.x = element_text(size=5, angle=45, hjust = 1))
## GSW
b2b_2018_GSW <- density_drives_2018_19 %>%
filter(B2B.2nd == "Yes") %>%
filter(drives > 0) %>%
group_by(player_id) %>%
filter(team_abbreviation == "GSW")
other_2018_GSW <- density_drives_2018_19 %>%
filter(B2B.2nd == "No") %>%
filter(drives > 0) %>%
group_by(player_id) %>%
filter(team_abbreviation == "GSW")
notB2b_2018_GSW_pass <- aggregate(other_2018_GSW$drive_passes_pct / nrow(other_2018_GSW), list(other_2084_GSW$player_name), FUN=sum, na.rm = TRUE)
##ATL
b2b_2018_ATL <- density_drives_2018_19 %>%
filter(B2B.2nd == "Yes") %>%
filter(drives > 0) %>%
group_by(player_id) %>%
filter(team_abbreviation == "ATL")
other_2018_ATL <- density_drives_2018_19 %>%
filter(B2B.2nd == "No") %>%
filter(drives > 0) %>%
group_by(player_id) %>%
filter(team_abbreviation == "ATL")
notB2b_2018_ATL_pass <- aggregate(other_2018_ATL$drive_passes_pct / nrow(other_2018_ATL), list(other_2018_ATL$player_name), FUN=sum, na.rm = TRUE)
B2b_2018_ATL_pass <-aggregate(b2b_2018_ATL$drive_passes_pct / nrow(b2b_2018_ATL), list(b2b_2018_ATL$player_name), FUN=sum, na.rm = TRUE)
drive_pct_2018_ATL_pass <- merge(B2b_2018_ATL_pass, notB2b_2018_ATL_pass, by = "Group.1") %>%
rename("2nd_B2B_game" = x.x, "not_2nd_B2B" = x.y)
drive_2018_ATL_long_pass <- drive_pct_2018_ATL_pass %>%
gather("Stat", "Value", -Group.1)
p1 <- ggplot(drive_2018_ATL_long_pass, aes(x = Group.1, y = Value, fill = Stat)) +
geom_bar(stat = "Identity", position = "dodge") +
theme_bw() +
ggtitle("Atlanta Hawks") +
xlab("Players") +
ylab("avg drive_pts_percent") +
scale_fill_manual("Stat", values = c("not_2nd_B2B" = "black", "2nd_B2B_game" = "skyblue")) +
theme(axis.text.x = element_text(size=5, angle=45, hjust = 1))
## GSW
b2b_2018_GSW <- density_drives_2018_19 %>%
filter(B2B.2nd == "Yes") %>%
filter(drives > 0) %>%
group_by(player_id) %>%
filter(team_abbreviation == "GSW")
other_2018_GSW <- density_drives_2018_19 %>%
filter(B2B.2nd == "No") %>%
filter(drives > 0) %>%
group_by(player_id) %>%
filter(team_abbreviation == "GSW")
notB2b_2018_GSW_pass <- aggregate(other_2018_GSW$drive_passes_pct / nrow(other_2018_GSW), list(other_2018_GSW$player_name), FUN=sum, na.rm = TRUE)
b2b_2018_GSW_pass <-aggregate(b2b_2018_GSW$drive_passes_pct/ nrow(b2b_2018_GSW), list(b2b_2018_GSW$player_name), FUN=sum, na.rm = TRUE)
drive_pct_2018_GSW_pass <- merge(b2b_2018_GSW_pass, notB2b_2018_GSW_pass, by = "Group.1") %>%
rename("2nd_B2B_game" = x.x, "not_2nd_B2B" = x.y)
drive_2018_GSW_long_pass <- drive_pct_2018_GSW_pass %>%
gather("Stat", "Value", -Group.1)
p2 <- ggplot(drive_2018_GSW_long_pass, aes(x = Group.1, y = Value, fill = Stat)) +
geom_bar(stat = "Identity", position = "dodge") +
theme_bw() +
ggtitle("Golden State Warriors") +
xlab("Players") +
ylab("avg drive_pts_percent") +
scale_fill_manual("Stat", values = c("not_2nd_B2B" = "black", "2nd_B2B_game" = "skyblue")) +
theme(axis.text.x = element_text(size=5, angle=45, hjust = 1))
##MIN
b2b_2018_MIN <- density_drives_2018_19 %>%
filter(B2B.2nd == "Yes") %>%
filter(drives > 0) %>%
group_by(player_id) %>%
filter(team_abbreviation == "MIN")
other_2018_MIN <- density_drives_2018_19 %>%
filter(B2B.2nd == "No") %>%
filter(drives > 0) %>%
group_by(player_id) %>%
filter(team_abbreviation == "MIN")
notB2b_2018_MIN_pass <- aggregate(other_2018_MIN$drive_passes_pct / nrow(other_2018_MIN), list(other_2018_MIN$player_name), FUN=sum, na.rm = TRUE)
b2b_2018_MIN_pass <-aggregate(b2b_2018_MIN$drive_passes_pct / nrow(b2b_2018_MIN), list(b2b_2018_MIN$player_name), FUN=sum, na.rm = TRUE)
drive_pct_2018_MIN_pass <- merge(b2b_2018_MIN_pass, notB2b_2018_MIN_pass, by = "Group.1") %>%
rename("2nd_B2B_game" = x.x, "not_2nd_B2B" = x.y)
drive_2018_MIN_long_pass <- drive_pct_2018_MIN_pass %>%
gather("Stat", "Value", -Group.1)
p3 <- ggplot(drive_2018_MIN_long_pass, aes(x = Group.1, y = Value, fill = Stat)) +
geom_bar(stat = "Identity", position = "dodge") +
theme_bw() +
ggtitle("Minnesota Timberwolves") +
xlab("Players") +
ylab("avg drive_pts_percent") +
scale_fill_manual("Stat", values = c("not_2nd_B2B" = "black", "2nd_B2B_game" = "skyblue")) +
theme(axis.text.x = element_text(size=5, angle=45, hjust = 1))
## NYK
b2b_2018_NYK <- density_drives_2018_19 %>%
filter(B2B.2nd == "Yes") %>%
filter(drives > 0) %>%
group_by(player_id) %>%
filter(team_abbreviation == "NYK")
other_2018_NYK <- density_drives_2018_19 %>%
filter(B2B.2nd == "No") %>%
filter(drives > 0) %>%
group_by(player_id) %>%
filter(team_abbreviation == "NYK")
notB2b_2018_NYK_pass <- aggregate((other_2018_NYK$drive_passes_pct) / nrow(other_2018_NYK), list(other_2018_NYK$player_name), FUN=sum, na.rm = TRUE)
b2b_2018_NYK_pass <-aggregate((b2b_2018_NYK$drive_passes_pct) / nrow(b2b_2018_NYK), list(b2b_2018_NYK$player_name), FUN=sum, na.rm = TRUE)
drive_pct_2014_NYK_pass <- merge(b2b_2014_NYK_pass, notB2b_2014_NYK_pass, by = "Group.1") %>%
rename("2nd_B2B_game" = x.x, "not_2nd_B2B" = x.y)
drive_2018_NYK_long_pass <- drive_pct_2014_NYK_pass %>%
gather("Stat", "Value", -Group.1)
p4 <- ggplot(drive_2018_NYK_long_pass, aes(x = Group.1, y = Value, fill = Stat)) +
geom_bar(stat = "Identity", position = "dodge") +
theme_bw()  +
ggtitle("New York Knicks") +
xlab("Players") +
ylab("avg drive_pts_percent") +
scale_fill_manual("Stat", values = c("not_2nd_B2B" = "black", "2nd_B2B_game" = "skyblue")) +
theme(axis.text.x = element_text(size=5, angle=45, hjust = 1))
grid.arrange(p2, p3, p1, p4, nrow = 2, ncol = 2)
density_drives_2014_15 %>%
select(c("team_abbreviation","player_name","w","l", "drives", "drive_pts", "drive_pts_pct", "drive_passes_pct", "drive_tov_pct", "dist_miles", "B2B.2nd")) %>%
rename("Team" = team_abbreviation,
"Player" = player_name,
"Distance (mi)" = dist_miles,
"# of Drives" = drives,
"2nd of a B2B" = B2B.2nd) %>%
slice(5:10) %>%
gt() %>%
tab_header(
title = md("**Drives, Distance, and Schedule Density by Player**")
) %>%
tab_source_note(md("data courtesy of nba.com and Second Spectrum")) %>%
opt_table_outline( style = "solid", width = px(5), color = "darkgrey")
xaringan:::inf_mr()
xaringan:::inf_mr()
##ATL
b2b_2018_ATL <- density_drives_2018_19 %>%
filter(B2B.2nd == "Yes") %>%
filter(drives > 0) %>%
group_by(player_id) %>%
filter(team_abbreviation == "ATL")
other_2018_ATL <- density_drives_2018_19 %>%
filter(B2B.2nd == "No") %>%
filter(drives > 0) %>%
group_by(player_id) %>%
filter(team_abbreviation == "ATL")
notB2b_2018_ATL_pass <- aggregate(other_2018_ATL$drive_passes_pct / nrow(other_2018_ATL), list(other_2018_ATL$player_name), FUN=sum, na.rm = TRUE)
B2b_2018_ATL_pass <-aggregate(b2b_2018_ATL$drive_passes_pct / nrow(b2b_2018_ATL), list(b2b_2018_ATL$player_name), FUN=sum, na.rm = TRUE)
drive_pct_2018_ATL_pass <- merge(B2b_2018_ATL_pass, notB2b_2018_ATL_pass, by = "Group.1") %>%
rename("2nd_B2B_game" = x.x, "not_2nd_B2B" = x.y)
drive_2018_ATL_long_pass <- drive_pct_2018_ATL_pass %>%
gather("Stat", "Value", -Group.1)
p1 <- ggplot(drive_2018_ATL_long_pass, aes(x = Group.1, y = Value, fill = Stat)) +
geom_bar(stat = "Identity", position = "dodge") +
theme_bw() +
ggtitle("Atlanta Hawks") +
xlab("Players") +
ylab("avg drive_pts_percent") +
scale_fill_manual("Stat", values = c("not_2nd_B2B" = "black", "2nd_B2B_game" = "skyblue")) +
theme(axis.text.x = element_text(size=5, angle=45, hjust = 1))
## GSW
b2b_2018_GSW <- density_drives_2018_19 %>%
filter(B2B.2nd == "Yes") %>%
filter(drives > 0) %>%
group_by(player_id) %>%
filter(team_abbreviation == "GSW")
other_2018_GSW <- density_drives_2018_19 %>%
filter(B2B.2nd == "No") %>%
filter(drives > 0) %>%
group_by(player_id) %>%
filter(team_abbreviation == "GSW")
notB2b_2018_GSW_pass <- aggregate(other_2018_GSW$drive_passes_pct / nrow(other_2018_GSW), list(other_2018_GSW$player_name), FUN=sum, na.rm = TRUE)
b2b_2018_GSW_pass <-aggregate(b2b_2018_GSW$drive_passes_pct/ nrow(b2b_2018_GSW), list(b2b_2018_GSW$player_name), FUN=sum, na.rm = TRUE)
drive_pct_2018_GSW_pass <- merge(b2b_2018_GSW_pass, notB2b_2018_GSW_pass, by = "Group.1") %>%
rename("2nd_B2B_game" = x.x, "not_2nd_B2B" = x.y)
drive_2018_GSW_long_pass <- drive_pct_2018_GSW_pass %>%
gather("Stat", "Value", -Group.1)
p2 <- ggplot(drive_2018_GSW_long_pass, aes(x = Group.1, y = Value, fill = Stat)) +
geom_bar(stat = "Identity", position = "dodge") +
theme_bw() +
ggtitle("Golden State Warriors") +
xlab("Players") +
ylab("avg drive_pts_percent") +
scale_fill_manual("Stat", values = c("not_2nd_B2B" = "black", "2nd_B2B_game" = "skyblue")) +
theme(axis.text.x = element_text(size=5, angle=45, hjust = 1))
##MIN
b2b_2018_MIN <- density_drives_2018_19 %>%
filter(B2B.2nd == "Yes") %>%
filter(drives > 0) %>%
group_by(player_id) %>%
filter(team_abbreviation == "MIN")
other_2018_MIN <- density_drives_2018_19 %>%
filter(B2B.2nd == "No") %>%
filter(drives > 0) %>%
group_by(player_id) %>%
filter(team_abbreviation == "MIN")
notB2b_2018_MIN_pass <- aggregate(other_2018_MIN$drive_passes_pct / nrow(other_2018_MIN), list(other_2018_MIN$player_name), FUN=sum, na.rm = TRUE)
b2b_2018_MIN_pass <-aggregate(b2b_2018_MIN$drive_passes_pct / nrow(b2b_2018_MIN), list(b2b_2018_MIN$player_name), FUN=sum, na.rm = TRUE)
drive_pct_2018_MIN_pass <- merge(b2b_2018_MIN_pass, notB2b_2018_MIN_pass, by = "Group.1") %>%
rename("2nd_B2B_game" = x.x, "not_2nd_B2B" = x.y)
drive_2018_MIN_long_pass <- drive_pct_2018_MIN_pass %>%
gather("Stat", "Value", -Group.1)
p3 <- ggplot(drive_2018_MIN_long_pass, aes(x = Group.1, y = Value, fill = Stat)) +
geom_bar(stat = "Identity", position = "dodge") +
theme_bw() +
ggtitle("Minnesota Timberwolves") +
xlab("Players") +
ylab("avg drive_pts_percent") +
scale_fill_manual("Stat", values = c("not_2nd_B2B" = "black", "2nd_B2B_game" = "skyblue")) +
theme(axis.text.x = element_text(size=5, angle=45, hjust = 1))
## NYK
b2b_2018_NYK <- density_drives_2018_19 %>%
filter(B2B.2nd == "Yes") %>%
filter(drives > 0) %>%
group_by(player_id) %>%
filter(team_abbreviation == "NYK")
other_2018_NYK <- density_drives_2018_19 %>%
filter(B2B.2nd == "No") %>%
filter(drives > 0) %>%
group_by(player_id) %>%
filter(team_abbreviation == "NYK")
notB2b_2018_NYK_pass <- aggregate((other_2018_NYK$drive_passes_pct) / nrow(other_2018_NYK), list(other_2018_NYK$player_name), FUN=sum, na.rm = TRUE)
b2b_2018_NYK_pass <-aggregate((b2b_2018_NYK$drive_passes_pct) / nrow(b2b_2018_NYK), list(b2b_2018_NYK$player_name), FUN=sum, na.rm = TRUE)
drive_pct_2014_NYK_pass <- merge(b2b_2014_NYK_pass, notB2b_2014_NYK_pass, by = "Group.1") %>%
rename("2nd_B2B_game" = x.x, "not_2nd_B2B" = x.y)
drive_2018_NYK_long_pass <- drive_pct_2014_NYK_pass %>%
gather("Stat", "Value", -Group.1)
p4 <- ggplot(drive_2018_NYK_long_pass, aes(x = Group.1, y = Value, fill = Stat)) +
geom_bar(stat = "Identity", position = "dodge") +
theme_bw()  +
ggtitle("New York Knicks") +
xlab("Players") +
ylab("avg drive_pts_percent") +
scale_fill_manual("Stat", values = c("not_2nd_B2B" = "black", "2nd_B2B_game" = "skyblue")) +
theme(axis.text.x = element_text(size=5, angle=45, hjust = 1))
grid.arrange(p2, p3, p1, p4, nrow = 2, ncol = 2)
xaringan:::inf_mr()
##ATL
b2b_2014_ALL <- density_drives_2014_15 %>%
filter(B2B.2nd == "Yes") %>%
filter(drives > 0) %>%
group_by(team_abbreviation)
library(readr)
library(dplyr)
library(tidyverse)
library(gt)
library(xaringanthemer)
library(teamcolors)
library(usmap)
library(ggplot2)
library(maps)
library(mapdata)
library(airball)
library(gridExtra)
density_drives_2014_15 <- read.csv("./data1/density_distance_drives_tracking/_density_drives_distance_daily_2014_15.csv")
density_drives_2018_19 <- read.csv("./data1/density_distance_drives_tracking/_density_drives_distance_daily_2018_19.csv")
##ATL
b2b_2014_ALL <- density_drives_2014_15 %>%
filter(B2B.2nd == "Yes") %>%
filter(drives > 0) %>%
group_by(team_abbreviation)
other_2014_ALL <- density_drives_2014_15 %>%
filter(B2B.2nd == "No") %>%
filter(drives > 0) %>%
group_by(team_abbreviation)
notB2b_2014_ALL_pass <- aggregate(other_2014_ALL$drive_passes_pct / nrow(other_2014_ALL), list(other_2014_ALL$team_abbreviation), FUN=sum, na.rm = TRUE)
notB2b_2014_ALL_pass
B2b_2014_ALL_pass <-aggregate(b2b_2014_ALL$drive_passes_pct / nrow(b2b_2014_ATL), list(b2b_2014_ALL$team_abbreviation), FUN=sum, na.rm = TRUE)
B2b_2014_ALL_pass <-aggregate(b2b_2014_ALL$drive_passes_pct / nrow(b2b_2014_ALL), list(b2b_2014_ALL$team_abbreviation), FUN=sum, na.rm = TRUE)
drive_pct_2014_ALL_pass <- merge(B2b_2014_ALL_pass, notB2b_2014_ALL_pass, by = "Group.1") %>%
rename("2nd_B2B_game" = x.x, "not_2nd_B2B" = x.y)
drive_2014_ALL_long_pass <- drive_pct_2014_ALL_pass %>%
gather("Stat", "Value", -Group.1)
ggplot(drive_2014_ALL_long_pass, aes(x = Group.1, y = Value, fill = Stat)) +
geom_bar(stat = "Identity", position = "dodge") +
theme_bw() +
ggtitle("Atlanta Hawks") +
xlab("Players") +
ylab("avg drive_pts_percent") +
scale_fill_manual("Stat", values = c("not_2nd_B2B" = "black", "2nd_B2B_game" = "skyblue")) +
theme(axis.text.x = element_text(size=5, angle=45, hjust = 1))
drive_2014_ALL_long_pass <- drive_pct_2014_ALL_pass %>%
gather("Stat", "Value", -Group.1) %>%
mutate(team = fct_reorder(Group.1, "Value"))
drive_2014_ALL_long_pass <- drive_pct_2014_ALL_pass %>%
gather("Stat", "Value", -Group.1) %>%
mutate(team = fct_reorder(Group.1, Value))
drive_2014_ALL_long_pass
ggplot(drive_2014_ALL_long_pass, aes(x = Group.1, y = Value, fill = Stat)) +
geom_bar(stat = "Identity", position = "dodge") +
theme_bw() +
ggtitle("Atlanta Hawks") +
xlab("Players") +
ylab("avg drive_pts_percent") +
scale_fill_manual("Stat", values = c("not_2nd_B2B" = "black", "2nd_B2B_game" = "skyblue")) +
theme(axis.text.x = element_text(size=5, angle=45, hjust = 1))
##ALL
b2b_2014_ALL <- density_drives_2014_15 %>%
filter(B2B.2nd == "Yes") %>%
filter(drives > 0) %>%
group_by(team_abbreviation)
other_2014_ALL <- density_drives_2014_15 %>%
filter(B2B.2nd == "No") %>%
filter(drives > 0) %>%
group_by(team_abbreviation)
notB2b_2014_ALL_pts <- aggregate(other_2014_ALL$drive_pts_pct / nrow(other_2014_ALL), list(other_2014_ALL$team_abbreviation), FUN=sum, na.rm = TRUE)
B2b_2014_ALL_pts <-aggregate(b2b_2014_ALL$drive_pts_pct / nrow(b2b_2014_ALL), list(b2b_2014_ALL$team_abbreviation), FUN=sum, na.rm = TRUE)
drive_pct_2014_ALL_pts <- merge(B2b_2014_ALL_pts, notB2b_2014_ALL_pts, by = "Group.1") %>%
rename("2nd_B2B_game" = x.x, "not_2nd_B2B" = x.y)
drive_2014_ALL_long_pts <- drive_pct_2014_ALL_pts %>%
gather("Stat", "Value", -Group.1)
ggplot(drive_2014_ALL_long_pts, aes(x = Group.1, y = Value, fill = Stat)) +
geom_bar(stat = "Identity", position = "dodge") +
theme_bw("Average Percent of drives that result in a pass") +
xlab("Players") +
ylab("avg drive passes percent") +
scale_fill_manual("Stat", values = c("not_2nd_B2B" = "black", "2nd_B2B_game" = "skyblue")) +
theme(axis.text.x = element_text(size=7, angle=45, hjust = 1))
##ALL
b2b_2014_ALL <- density_drives_2014_15 %>%
filter(B2B.2nd == "Yes") %>%
filter(drives > 0) %>%
group_by(team_abbreviation)
other_2014_ALL <- density_drives_2014_15 %>%
filter(B2B.2nd == "No") %>%
filter(drives > 0) %>%
group_by(team_abbreviation)
notB2b_2014_ALL_pts <- aggregate(other_2014_ALL$drive_pts_pct / nrow(other_2014_ALL), list(other_2014_ALL$team_abbreviation), FUN=sum, na.rm = TRUE)
B2b_2014_ALL_pts <-aggregate(b2b_2014_ALL$drive_pts_pct / nrow(b2b_2014_ALL), list(b2b_2014_ALL$team_abbreviation), FUN=sum, na.rm = TRUE)
drive_pct_2014_ALL_pts <- merge(B2b_2014_ALL_pts, notB2b_2014_ALL_pts, by = "Group.1") %>%
rename("2nd_B2B_game" = x.x, "not_2nd_B2B" = x.y)
drive_2014_ALL_long_pts <- drive_pct_2014_ALL_pts %>%
gather("Stat", "Value", -Group.1)
ggplot(drive_2014_ALL_long_pts, aes(x = Group.1, y = Value, fill = Stat)) +
geom_bar(stat = "Identity", position = "dodge") +
theme_bw("Average Percent of drives that result in a pass") +
xlab("Players") +
ylab("avg drive passes percent") +
scale_fill_manual("Stat", values = c("not_2nd_B2B" = "black", "2nd_B2B_game" = "skyblue")) +
theme(axis.text.x = element_text(size=7, angle=45, hjust = 1))
p1 <- ggplot(drive_2014_ALL_long_pts, aes(x = Group.1, y = Value, fill = Stat)) +
geom_bar(stat = "Identity", position = "dodge") +
theme_bw("Average Percent of drives that result in a pass") +
xlab("Players") +
ylab("avg drive passes percent") +
scale_fill_manual("Stat", values = c("not_2nd_B2B" = "black", "2nd_B2B_game" = "skyblue")) +
theme(axis.text.x = element_text(size=7, angle=45, hjust = 1))
##ALL
b2b_2014_ALL <- density_drives_2014_15 %>%
filter(B2B.2nd == "Yes") %>%
filter(drives > 0) %>%
group_by(team_abbreviation)
other_2014_ALL <- density_drives_2014_15 %>%
filter(B2B.2nd == "No") %>%
filter(drives > 0) %>%
group_by(team_abbreviation)
notB2b_2014_ALL_pass <- aggregate(other_2014_ALL$drive_passes_pct / nrow(other_2014_ALL), list(other_2014_ALL$team_abbreviation), FUN=sum, na.rm = TRUE)
B2b_2014_ALL_pass <-aggregate(b2b_2014_ALL$drive_passes_pct / nrow(b2b_2014_ALL), list(b2b_2014_ALL$team_abbreviation), FUN=sum, na.rm = TRUE)
drive_pct_2014_ALL_pass <- merge(B2b_2014_ALL_pass, notB2b_2014_ALL_pass, by = "Group.1") %>%
rename("2nd_B2B_game" = x.x, "not_2nd_B2B" = x.y)
drive_2014_ALL_long_pass <- drive_pct_2014_ALL_pass %>%
gather("Stat", "Value", -Group.1)
ggplot(drive_2014_ALL_long_pass, aes(x = Group.1, y = Value, fill = Stat)) +
geom_bar(stat = "Identity", position = "dodge") +
theme_bw("Average Percent of drives that result in a pass") +
xlab("Players") +
ylab("avg drive passes percent") +
scale_fill_manual("Stat", values = c("not_2nd_B2B" = "black", "2nd_B2B_game" = "skyblue")) +
theme(axis.text.x = element_text(size=7, angle=45, hjust = 1))
##ALL
b2b_2014_ALL <- density_drives_2014_15 %>%
filter(B2B.2nd == "Yes") %>%
filter(drives > 0) %>%
group_by(team_abbreviation)
other_2014_ALL <- density_drives_2014_15 %>%
filter(B2B.2nd == "No") %>%
filter(drives > 0) %>%
group_by(team_abbreviation)
notB2b_2014_ALL_pass <- aggregate(other_2014_ALL$drive_passes_pct / nrow(other_2014_ALL), list(other_2014_ALL$team_abbreviation), FUN=sum, na.rm = TRUE)
B2b_2014_ALL_pass <-aggregate(b2b_2014_ALL$drive_passes_pct / nrow(b2b_2014_ALL), list(b2b_2014_ALL$team_abbreviation), FUN=sum, na.rm = TRUE)
drive_pct_2014_ALL_pass <- merge(B2b_2014_ALL_pass, notB2b_2014_ALL_pass, by = "Group.1") %>%
rename("2nd_B2B_game" = x.x, "not_2nd_B2B" = x.y)
drive_2014_ALL_long_pass <- drive_pct_2014_ALL_pass %>%
gather("Stat", "Value", -Group.1)
p1 <- ggplot(drive_2014_ALL_long_pass, aes(x = Group.1, y = Value, fill = Stat)) +
geom_bar(stat = "Identity", position = "dodge") +
theme_bw("Average Percent of drives that result in a pass") +
xlab("Players") +
ylab("avg drive passes percent") +
scale_fill_manual("Stat", values = c("not_2nd_B2B" = "black", "2nd_B2B_game" = "skyblue")) +
theme(axis.text.x = element_text(size=7, angle=45, hjust = 1))
ggplot(drive_2014_ALL_long_pass, aes(x = Group.1, y = Value, fill = Stat)) +
geom_bar(stat = "Identity", position = "dodge") +
theme_bw() +
ggtitle("Atlanta Hawks") +
xlab("Players") +
ylab("avg drive passes percent") +
scale_fill_manual("Stat", values = c("not_2nd_B2B" = "black", "2nd_B2B_game" = "skyblue")) +
theme(axis.text.x = element_text(size=7, angle=45, hjust = 1))
ggplot(drive_2014_ALL_long_pass, aes(x = Group.1, y = Value, fill = Stat)) +
geom_bar(stat = "Identity", position = "dodge") +
theme_bw() +
ggtitle("Average percent of drives that are passed by each NBA team") +
xlab("Players") +
ylab("avg drive passes percent") +
scale_fill_manual("Stat", values = c("not_2nd_B2B" = "black", "2nd_B2B_game" = "skyblue")) +
theme(axis.text.x = element_text(size=7, angle=45, hjust = 1))
##ALL
b2b_2014_ALL <- density_drives_2014_15 %>%
filter(B2B.2nd == "Yes") %>%
filter(drives > 0) %>%
group_by(team_abbreviation)
other_2014_ATL <- density_drives_2014_15 %>%
filter(B2B.2nd == "No") %>%
filter(drives > 0) %>%
group_by(player_id) %>%
filter(team_abbreviation == "ATL")
notB2b_2014_ATL_pass <- aggregate(other_2014_ATL$drive_passes_pct / nrow(other_2014_ATL), list(other_2014_ATL$player_name), FUN=sum, na.rm = TRUE)
B2b_2014_ATL_pass <-aggregate(b2b_2014_ATL$drive_passes_pct / nrow(b2b_2014_ATL), list(b2b_2014_ATL$player_name), FUN=sum, na.rm = TRUE)
B2b_2014_ALL_pts <-aggregate(b2b_2014_ALL$drive_pts_pct / nrow(b2b_2014_ALL), list(b2b_2014_ALL$team_abbreviation), FUN=sum, na.rm = TRUE)
notB2b_2014_ALL_pts <- aggregate(other_2014_ALL$drive_pts_pct / nrow(other_2014_ALL), list(other_2014_ALL$team_abbreviation), FUN=sum, na.rm = TRUE)
drive_pct_2014_ALL_pts <- merge(B2b_2014_ALL_pts, notB2b_2014_ALL_pts, by = "Group.1") %>%
rename("2nd_B2B_game" = x.x, "not_2nd_B2B" = x.y)
drive_2014_ALL_long_pts <- drive_pct_2014_ALL_pts %>%
gather("Stat", "Value", -Group.1)
ggplot(drive_2014_ALL_long_pts, aes(x = Group.1, y = Value, fill = Stat)) +
geom_bar(stat = "Identity", position = "dodge") +
theme_bw() +
ggtitle("Average percent of drives that are passed by each NBA team") +
xlab("Players") +
ylab("avg drive passes percent") +
scale_fill_manual("Stat", values = c("not_2nd_B2B" = "black", "2nd_B2B_game" = "skyblue")) +
theme(axis.text.x = element_text(size=7, angle=45, hjust = 1))
xaringan:::inf_mr()
