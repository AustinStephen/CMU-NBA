wind_25_hollow + wind_30_hollow + wind_35_hollow + wind_40_hollow
+ three_in_four
+ travel_3_hours_back + rest_diff,
data = together_net_Rating_allWindows))
summary(lm(game_net_rating ~ wind_10_center + hollow_wind20_cent + hollow_wind30_cent+
hollow_wind40_cent + hollow_wind50_cent + hollow_wind60_cent + net_rating_diff +
+ three_in_four
+ travel_3_hours_back + rest_diff,
data = together_net_Rating_allWindows))
summary(lm(game_net_rating ~ wind_10_center + hollow_wind20_cent + hollow_wind30_cent+
hollow_wind40_cent + hollow_wind50_cent + hollow_wind60_cent +
+ three_in_four
+ travel_3_hours_back + rest_diff,
data = together_net_Rating_allWindows))
colnames(together_net_Rating_allWindows)
summary(lm(score_diff ~ wind_10_center + hollow_wind20_cent + hollow_wind30_cent+
hollow_wind40_cent + hollow_wind50_cent + hollow_wind60_cent +
+ three_in_four
+ travel_3_hours_back + rest_diff,
data = together_net_Rating_allWindows))
summary(lm(score_diff ~ wind_10_center + hollow_wind20_cent + hollow_wind30_cent+
hollow_wind40_cent + hollow_wind50_cent + hollow_wind60_cent +
+ three_in_four
+ travel_3_hours_back + rest_diff + distance_diff,
data = together_net_Rating_allWindows))
summary(lm(score_diff ~ wind_10_center + hollow_wind20_cent + hollow_wind30_cent+
hollow_wind40_cent + hollow_wind50_cent + hollow_wind60_cent +
+ three_in_four
+ travel_3_hours_back + rest_diff + windowed_distance_diff,
data = together_net_Rating_allWindows))
summary(lm(score_diff ~ wind_10_center + hollow_wind20_cent + hollow_wind30_cent+
hollow_wind40_cent + hollow_wind50_cent + hollow_wind60_cent +
+ three_in_four
+ travel_3_hours_back + rest_diff + windowed_distance_advantage,
data = together_net_Rating_allWindows))
summary(lm(score_diff ~ wind_10_center + hollow_wind20_cent + hollow_wind30_cent+
hollow_wind40_cent + hollow_wind50_cent + hollow_wind60_cent +
+ three_in_four
+ travel_3_hours_back + rest_diff + distance_advantage,
data = together_net_Rating_allWindows))
summary(lm(score_diff ~ wind_10_center + hollow_wind20_cent + hollow_wind30_cent+
hollow_wind40_cent + hollow_wind50_cent + hollow_wind60_cent +
+ three_in_four
+ travel_3_hours_back + rest_advantage,
data = together_net_Rating_allWindows))
summary(lm(score_diff ~ wind_10_center + hollow_wind20_cent + hollow_wind30_cent+
hollow_wind40_cent + hollow_wind50_cent + hollow_wind60_cent +
+ three_in_four
+ travel_3_hours_back + rest_advantage + rest_diff,
data = together_net_Rating_allWindows))
summary(lm(score_diff ~ wind_10_center + hollow_wind20_cent + hollow_wind30_cent+
hollow_wind40_cent + hollow_wind50_cent + hollow_wind60_cent +
+ three_in_four
+ travel_3_hours_back + rest_diff,
data = together_net_Rating_allWindows))
#Interesting to see that there are quite a bit of blowout losses when EST teams play at night
ggplot(data = night_game_for_east_visiting_west, aes(x= capped_score_diff)) +
geom_histogram( color = "black", fill = "white")
#Using just net_rating_diff
summary(lm(game_net_rating ~ net_rating_diff*games_played + three_in_four
+ travel_3_hours_back + rest_diff,
data = together_net_Rating_allWindows))
# Using centered hollowed net ratings -------------------------------------
summary(lm(game_net_rating ~ wind_10_center + hollow_wind20_cent + hollow_wind30_cent+
hollow_wind40_cent + hollow_wind50_cent + hollow_wind60_cent +
+ three_in_four + travel_3_hours_back + rest_diff,
data = together_net_Rating_allWindows))
# Using hollowed net ratings ----------------------------------------------
summary(lm(game_net_rating ~ wind_5 + wind_10_hollow_5 + wind_15_hollow + wind_20_hollow +
wind_25_hollow + wind_30_hollow + wind_35_hollow + wind_40_hollow
+ three_in_four + travel_3_hours_back + rest_diff,
data = together_net_Rating_allWindows))
# Using centered hollowed net ratings -------------------------------------
summary(lm(game_net_rating ~ wind_10_center + hollow_wind20_cent + hollow_wind30_cent+
hollow_wind40_cent + hollow_wind50_cent + hollow_wind60_cent +
+ three_in_four + travel_3_hours_back + rest_diff,
data = together_net_Rating_allWindows))
strength_lm <- lm(game_net_rating ~ wind_10_center + hollow_wind20_cent + hollow_wind30_cent+
hollow_wind40_cent + hollow_wind50_cent + hollow_wind60_cent +
games_played* net_rating_diff,
data = together_net_Rating_allWindows)
summary(strength_lm <- lm(game_net_rating ~ wind_10_center + hollow_wind20_cent + hollow_wind30_cent+
hollow_wind40_cent + hollow_wind50_cent + hollow_wind60_cent +
games_played* net_rating_diff,
data = together_net_Rating_allWindows))
sum(together$travel_3_hours_back_vis)
sum(together_net_Rating_allWindows$travel_3_hours_back_vis)
sum(together_net_Rating_allWindows$travel_3_hours_back)
two_step_together = together_net_Rating_allWindows
summary(strength_lm <- lm(game_net_rating ~ wind_10_center + hollow_wind20_cent + hollow_wind30_cent+
hollow_wind40_cent + hollow_wind50_cent + hollow_wind60_cent +
games_played* net_rating_diff,
data = two_step_together))
# Assess Model Predictions ------------------------------------------------
two_step_together %>%
mutate(pred_vals = predict(strength_lm)) %>%
ggplot(aes(x = pred_vals, y = game_net_rating)) +
geom_point(alpha = 0.5) +
geom_abline(intercept = 0, slope = 1,
linetype = "dashed", color = "red",
size = 2) +
theme_bw()
library(broom)
two_step_together <-
broom::augment(strength_lm, two_step_together)
two_step_together %>%
ggplot(aes(x = .fitted, y = game_net_rating)) +
geom_point(alpha = 0.5) +
geom_abline(intercept = 0, slope = 1,
linetype = "dashed", color = "red",
size = 2) +
theme_bw()
# Model Diagnostics -------------------------------------------------------
#Residuals are centered around 0!!!!!!!
two_step_together %>%
ggplot(aes(x = .fitted, y = .resid)) +
geom_point(alpha = 0.5) +
geom_hline(yintercept = 0,
linetype = "dashed", color = "red",
size = 2) +
geom_smooth(se = FALSE) +
theme_bw()
#Next step is to regress these residuals on our travel and density metrics
strength_residuals <- resid(strength_lm)
second_lm <- lm(strength_residuals ~ rest_diff  + three_in_four + travel_3_hours_back,
data = two_step_together)
summary(second_lm <- lm(strength_residuals ~ rest_diff  + three_in_four + travel_3_hours_back,
data = two_step_together))
summary(strength_lm <- lm(game_net_rating ~ wind_10_center + hollow_wind20_cent + hollow_wind30_cent+
hollow_wind40_cent + hollow_wind50_cent + hollow_wind60_cent
,
data = two_step_together))
# Assess Model Predictions ------------------------------------------------
two_step_together %>%
mutate(pred_vals = predict(strength_lm)) %>%
ggplot(aes(x = pred_vals, y = game_net_rating)) +
geom_point(alpha = 0.5) +
geom_abline(intercept = 0, slope = 1,
linetype = "dashed", color = "red",
size = 2) +
theme_bw()
library(broom)
two_step_together <-
broom::augment(strength_lm, two_step_together)
two_step_together %>%
ggplot(aes(x = .fitted, y = game_net_rating)) +
geom_point(alpha = 0.5) +
geom_abline(intercept = 0, slope = 1,
linetype = "dashed", color = "red",
size = 2) +
theme_bw()
# Model Diagnostics -------------------------------------------------------
#Residuals are centered around 0!!!!!!!
two_step_together %>%
ggplot(aes(x = .fitted, y = .resid)) +
geom_point(alpha = 0.5) +
geom_hline(yintercept = 0,
linetype = "dashed", color = "red",
size = 2) +
geom_smooth(se = FALSE) +
theme_bw()
#Next step is to regress these residuals on our travel and density metrics
strength_residuals <- resid(strength_lm)
summary(second_lm <- lm(strength_residuals ~ rest_diff  + three_in_four + travel_3_hours_back,
data = two_step_together))
# Using centered hollowed net ratings -------------------------------------
summary(lm(game_net_rating ~ wind_10_center + hollow_wind20_cent + hollow_wind30_cent+
hollow_wind40_cent + hollow_wind50_cent + hollow_wind60_cent +
+ three_in_four + travel_3_hours_back + rest_diff,
data = together_net_Rating_allWindows))
# Using centered hollowed net ratings -------------------------------------
summary(lm(game_net_rating ~ wind_10_center + hollow_wind20_cent + hollow_wind30_cent+
hollow_wind40_cent + hollow_wind50_cent + hollow_wind60_cent +
+ three_in_four + travel_3_hours_back + rest_diff + net_rating_diff *games_played,
data = together_net_Rating_allWindows))
# Using hollowed net ratings ----------------------------------------------
summary(lm(game_net_rating ~ wind_5 + wind_10_hollow_5 + wind_15_hollow + wind_20_hollow +
wind_25_hollow + wind_30_hollow + wind_35_hollow + wind_40_hollow
+ three_in_four + travel_3_hours_back + rest_diff + + net_rating_diff *games_played,
data = together_net_Rating_allWindows))
# Using centered hollowed net ratings -------------------------------------
summary(lm(game_net_rating ~ wind_10_center + hollow_wind20_cent + hollow_wind30_cent+
hollow_wind40_cent + hollow_wind50_cent + hollow_wind60_cent +
+ three_in_four + travel_3_hours_back + rest_diff + nwin_percent_diff *games_played,
data = together_net_Rating_allWindows))
# Using centered hollowed net ratings -------------------------------------
summary(lm(game_net_rating ~ wind_10_center + hollow_wind20_cent + hollow_wind30_cent+
hollow_wind40_cent + hollow_wind50_cent + hollow_wind60_cent +
+ three_in_four + travel_3_hours_back + rest_diff + win_percent_diff *games_played,
data = together_net_Rating_allWindows))
# Using centered hollowed net ratings -------------------------------------
summary(lm(game_net_rating ~ wind_10_center + hollow_wind20_cent + hollow_wind30_cent+
hollow_wind40_cent + hollow_wind50_cent + hollow_wind60_cent +
+ three_in_four + travel_3_hours_back + rest_diff + net_rating_diff *games_played,
data = together_net_Rating_allWindows))
#Using just net_rating_diff
summary(lm(game_net_rating ~ net_rating_diff*games_played + three_in_four
+ travel_3_hours_back + rest_diff,
data = together_net_Rating_allWindows))
colnames(together_net_Rating_allWindows)
#Using just net_rating_diff
summary(lm(game_net_rating ~ net_rating_diff*games_played + three_in_four + four_in_five
+ travel_3_hours_back + rest_diff,
data = together_net_Rating_allWindows))
#Using just net_rating_diff
summary(lm(game_net_rating ~ net_rating_diff*games_played + three_in_four + Distance
+ travel_3_hours_back + rest_diff,
data = together_net_Rating_allWindows))
#Using just net_rating_diff
summary(lm(game_net_rating ~ net_rating_diff*games_played + three_in_four + distance_diff
+ travel_3_hours_back + rest_diff,
data = together_net_Rating_allWindows))
#Using just net_rating_diff
summary(lm(game_net_rating ~ net_rating_diff*games_played + three_in_four + windowed_distance_diff
+ travel_3_hours_back + rest_diff,
data = together_net_Rating_allWindows))
#Using just net_rating_diff
summary(lm(game_net_rating ~ net_rating_diff*games_played + three_in_four + distance_advantage
+ travel_3_hours_back + rest_diff,
data = together_net_Rating_allWindows))
#Using just net_rating_diff
summary(lm(game_net_rating ~ net_rating_diff*games_played + three_in_four + distance_advantage
+ travel_3_hours_back + rest_diff + shift,
data = together_net_Rating_allWindows))
#Using just net_rating_diff
summary(lm(game_net_rating ~ net_rating_diff*games_played + three_in_four + distance_advantage
+ travel_3_hours_back + rest_diff + hours_shift,
data = together_net_Rating_allWindows))
#Using just net_rating_diff
summary(lm(game_net_rating ~ net_rating_diff*games_played + three_in_four + distance_advantage
+ travel_3_hours_back + rest_diff,
data = together_net_Rating_allWindows))
#Using just net_rating_diff
summary(lm(game_net_rating ~ net_rating_diff*games_played + three_in_four + windowed_distance_diff
+ travel_3_hours_back + rest_diff,
data = together_net_Rating_allWindows))
#Using just net_rating_diff
summary(lm(score_diff ~ net_rating_diff*games_played + three_in_four + windowed_distance_diff
+ travel_3_hours_back + rest_diff,
data = together_net_Rating_allWindows))
#Using just net_rating_diff
summary(lm(game_net_rating ~ net_rating_diff*games_played + three_in_four + windowed_distance_diff
+ travel_3_hours_back + rest_diff,
data = together_net_Rating_allWindows))
#Using just net_rating_diff
summary(lm(game_net_rating ~ net_rating_diff*games_played + three_in_four + dist_30dayWindow
+ travel_3_hours_back + rest_diff,
data = together_net_Rating_allWindows))
#Using just net_rating_diff
summary(lm(game_net_rating ~ net_rating_diff+ three_in_four + dist_30dayWindow
+ travel_3_hours_back + rest_diff,
data = together_net_Rating_allWindows))
#Using just net_rating_diff
summary(lm(game_net_rating ~ net_rating_diff+ three_in_four +
+ travel_3_hours_back + rest_diff,
data = together_net_Rating_allWindows))
pre15 <- filter(together_net_Rating_allWindows, season %in% c("2010-11","2011-12","2012-13","2013-14","2014-15"))
post15 <- filter(together_net_Rating_allWindows, season %in% c("2015-16","2016-17","2017-18","2018-19"))
pre15 <- filter(together_net_Rating_allWindows, season %in% c("2010-11","2011-12","2012-13","2013-14","2014-15"))
post15 <- filter(together_net_Rating_allWindows, season %in% c("2015-16","2016-17","2017-18","2018-19"))
summary(lm(game_net_rating ~ net_rating_diff+ three_in_four +
+ travel_3_hours_back + rest_diff,
data = pre15))
summary(lm(game_net_rating ~ net_rating_diff+ three_in_four +
+ travel_3_hours_back + rest_diff,
data = post15))
visitors1011 <- filter(together_net_Rating_allWindows, season == "2010-11")
visitors1112 <- filter(together_net_Rating_allWindows, season == "2011-12")
visitors1213 <- filter(together_net_Rating_allWindows, season == "2012-13")
visitors1314 <- filter(together_net_Rating_allWindows, season == "2013-14")
visitors1415 <- filter(together_net_Rating_allWindows, season == "2014-15")
visitors1516 <- filter(together_net_Rating_allWindows, season == "2015-16")
visitors1617 <- filter(together_net_Rating_allWindows, season == "2016-17")
visitors1718 <- filter(together_net_Rating_allWindows, season == "2017-18")
visitors1819 <- filter(together_net_Rating_allWindows, season == "2018-19")
visitors1011 <- filter(together_net_Rating_allWindows, season == "2010-11")
visitors1112 <- filter(together_net_Rating_allWindows, season == "2011-12")
visitors1213 <- filter(together_net_Rating_allWindows, season == "2012-13")
visitors1314 <- filter(together_net_Rating_allWindows, season == "2013-14")
visitors1415 <- filter(together_net_Rating_allWindows, season == "2014-15")
visitors1516 <- filter(together_net_Rating_allWindows, season == "2015-16")
visitors1617 <- filter(together_net_Rating_allWindows, season == "2016-17")
visitors1718 <- filter(together_net_Rating_allWindows, season == "2017-18")
visitors1819 <- filter(together_net_Rating_allWindows, season == "2018-19")
lm1011 <- lm(game_net_rating  ~ net_rating_diff+ three_in_four +  b2b_2nd + windowed_distance_diff
+ travel_3_hours_back + rest_diff,
data = visitors1011)
lm1112 <- lm(game_net_rating  ~ net_rating_diff+ three_in_four +  b2b_2nd + windowed_distance_diff
+ travel_3_hours_back + rest_diff,
data = visitors1112)
lm1213 <- lm(game_net_rating ~ net_rating_diff+ three_in_four +  b2b_2nd + windowed_distance_diff
+ travel_3_hours_back + rest_diff,
data = visitors1213)
lm1314 <- lm(game_net_rating ~ ~ net_rating_diff+ three_in_four +  b2b_2nd + windowed_distance_diff
+ travel_3_hours_back + rest_diff,
data = visitors1314)
lm1415 <- lm(game_net_rating ~ net_rating_diff+ three_in_four +  b2b_2nd + windowed_distance_diff
+ travel_3_hours_back + rest_diff,
data = visitors1415)
lm1314 <- lm(game_net_rating  ~ net_rating_diff+ three_in_four +  b2b_2nd + windowed_distance_diff
+ travel_3_hours_back + rest_diff,
data = visitors1314)
lm1415 <- lm(game_net_rating ~ net_rating_diff+ three_in_four +  b2b_2nd + windowed_distance_diff
+ travel_3_hours_back + rest_diff,
data = visitors1415)
lm1516 <- lm(game_net_rating ~ net_rating_diff+ three_in_four +  b2b_2nd + windowed_distance_diff
+ travel_3_hours_back + rest_diff,
data = visitors1516)
lm1617 <- lm(game_net_rating ~ net_rating_diff+ three_in_four +  b2b_2nd + windowed_distance_diff
+ travel_3_hours_back + rest_diff,
data = visitors1617)
lm1718 <- lm(game_net_rating ~ net_rating_diff+ three_in_four +  b2b_2nd + windowed_distance_diff
+ travel_3_hours_back + rest_diff,
data = visitors1718)
lm1819 <- lm(game_net_rating ~ ~ net_rating_diff+ three_in_four +  b2b_2nd + windowed_distance_diff
+ travel_3_hours_back + rest_diff,
data = visitors1819)
lm1819 <- lm(game_net_rating  ~ net_rating_diff+ three_in_four +  b2b_2nd + windowed_distance_diff
+ travel_3_hours_back + rest_diff,
data = visitors1819)
coeffs1011 <- as.numeric(summary(lm1011)$coefficients[,1])
standard_errors1011 <- as.numeric(summary(lm1011)$coefficients[,2])
cfse1011 <- c(coeffs1011, standard_errors1011)
coeffs1112 <- as.numeric(summary(lm1112)$coefficients[,1])
standard_errors1112 <- as.numeric(summary(lm1112)$coefficients[,2])
cfse1112 <- c(coeffs1112, standard_errors1112)
coeffs1213 <- as.numeric(summary(lm1213)$coefficients[,1])
standard_errors1213 <- as.numeric(summary(lm1213)$coefficients[,2])
cfse1213 <- c(coeffs1213, standard_errors1213)
coeffs1314 <- as.numeric(summary(lm1314)$coefficients[,1])
standard_errors1314 <- as.numeric(summary(lm1314)$coefficients[,2])
cfse1314 <- c(coeffs1314 , standard_errors1314 )
coeffs1415 <- as.numeric(summary(lm1415)$coefficients[,1])
standard_errors1415 <- as.numeric(summary(lm1415)$coefficients[,2])
cfse1415 <- c(coeffs1415, standard_errors1415)
coeffs1516 <- as.numeric(summary(lm1516)$coefficients[,1])
standard_errors1516 <- as.numeric(summary(lm1516)$coefficients[,2])
cfse1516 <- c(coeffs1516, standard_errors1516)
coeffs1617 <- as.numeric(summary(lm1617)$coefficients[,1])
standard_errors1617 <- as.numeric(summary(lm1617)$coefficients[,2])
cfse1617 <- c(coeffs1617, standard_errors1617)
coeffs1718 <- as.numeric(summary(lm1718)$coefficients[,1])
standard_errors1718 <- as.numeric(summary(lm1718)$coefficients[,2])
cfse1718 <- c(coeffs1718, standard_errors1718)
coeffs1819 <- as.numeric(summary(lm1819)$coefficients[,1])
standard_errors1819 <- as.numeric(summary(lm1819)$coefficients[,2])
cfse1819 <- c(coeffs1819, standard_errors1819)
coeffs_and_standard_errors <- rbind(cfse1011, cfse1112)
coeffs_and_standard_errors <- rbind(coeffs_and_standard_errors, cfse1213)
coeffs_and_standard_errors <- rbind(coeffs_and_standard_errors, cfse1314)
coeffs_and_standard_errors <- rbind(coeffs_and_standard_errors, cfse1415)
coeffs_and_standard_errors <- rbind(coeffs_and_standard_errors, cfse1516)
coeffs_and_standard_errors <- rbind(coeffs_and_standard_errors, cfse1617)
coeffs_and_standard_errors <- rbind(coeffs_and_standard_errors, cfse1718)
coeffs_and_standard_errors <- rbind(coeffs_and_standard_errors, cfse1819)
coeffs_and_standard_errors <- as.data.frame(coeffs_and_standard_errors)
coeffs_and_standard_errors <- coeffs_and_standard_errors %>%
rename(intercept = V1,
net_rating_diff = V2,
three_in_four_vis = V3,
b2b_2nd_vis = V4,
windowed_distance_diff = V5,
travel_3_hours_back_vis = V6,
rest_diff= V7,
intercept_se = V8,
net_rating_diff_se = V9,
three_in_four_vis_se = V10,
b2b_2nd_vis_se = V11,
windowed_distance_diff_se = V12,
travel_3_hours_back_vis_se = V13,
rest_diff_se= V14,
)
coeffs_and_standard_errors <- mutate(coeffs_and_standard_errors, season = c(2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018))
View(coeffs_and_standard_errors)
visitors1819 <- visitors1819[-c(832),]
lm1819 <- lm(game_net_rating  ~ net_rating_diff+ three_in_four +  b2b_2nd + windowed_distance_diff
+ travel_3_hours_back + rest_diff,
data = visitors1819)
coeffs1819 <- as.numeric(summary(lm1819)$coefficients[,1])
standard_errors1819 <- as.numeric(summary(lm1819)$coefficients[,2])
cfse1819 <- c(coeffs1819, standard_errors1819)
coeffs_and_standard_errors <- rbind(cfse1011, cfse1112)
coeffs_and_standard_errors <- rbind(coeffs_and_standard_errors, cfse1213)
coeffs_and_standard_errors <- rbind(coeffs_and_standard_errors, cfse1314)
coeffs_and_standard_errors <- rbind(coeffs_and_standard_errors, cfse1415)
coeffs_and_standard_errors <- rbind(coeffs_and_standard_errors, cfse1516)
coeffs_and_standard_errors <- rbind(coeffs_and_standard_errors, cfse1617)
coeffs_and_standard_errors <- rbind(coeffs_and_standard_errors, cfse1718)
coeffs_and_standard_errors <- rbind(coeffs_and_standard_errors, cfse1819)
coeffs_and_standard_errors <- as.data.frame(coeffs_and_standard_errors)
coeffs_and_standard_errors <- coeffs_and_standard_errors %>%
rename(intercept = V1,
net_rating_diff = V2,
three_in_four_vis = V3,
b2b_2nd_vis = V4,
windowed_distance_diff = V5,
travel_3_hours_back_vis = V6,
rest_diff= V7,
intercept_se = V8,
net_rating_diff_se = V9,
three_in_four_vis_se = V10,
b2b_2nd_vis_se = V11,
windowed_distance_diff_se = V12,
travel_3_hours_back_vis_se = V13,
rest_diff_se= V14,
)
coeffs_and_standard_errors <- mutate(coeffs_and_standard_errors, season = c(2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018))
View(coeffs_and_standard_errors)
#Need to improve this with windowed distance and data with no duplicates
dy = coeffs_and_standard_errors$three_in_four_vis_se
var = coeffs_and_standard_errors$three_in_four_vis
ggplot(data = coeffs_and_standard_errors, aes(x = season, y = var)) +
geom_line(color = "blue") +
geom_point(size = 2, color = "blue") +
geom_errorbar(aes(ymin = var - 2*dy, ymax = var + 2*dy), width = 0.2) +
ylab("Game Net Rating")
View(coeffs_and_standard_errors)
#Need to improve this with windowed distance and data with no duplicates
dy = coeffs_and_standard_errors$travel_3_hours_back_vis_se
var = coeffs_and_standard_errors$travel_3_hours_back_vis
ggplot(data = coeffs_and_standard_errors, aes(x = season, y = var)) +
geom_line(color = "blue") +
geom_point(size = 2, color = "blue") +
geom_errorbar(aes(ymin = var - 2*dy, ymax = var + 2*dy), width = 0.2) +
ylab("Game Net Rating")
#Need to improve this with windowed distance and data with no duplicates
dy = coeffs_and_standard_errors$b2b_2nd_vis_se
var = coeffs_and_standard_errors$b2b_2nd_vis
ggplot(data = coeffs_and_standard_errors, aes(x = season, y = var)) +
geom_line(color = "blue") +
geom_point(size = 2, color = "blue") +
geom_errorbar(aes(ymin = var - 2*dy, ymax = var + 2*dy), width = 0.2) +
ylab("Game Net Rating")
#Need to improve this with windowed distance and data with no duplicates
dy = coeffs_and_standard_errors$rest_diff
var = coeffs_and_standard_errors$rest_diff
ggplot(data = coeffs_and_standard_errors, aes(x = season, y = var)) +
geom_line(color = "blue") +
geom_point(size = 2, color = "blue") +
geom_errorbar(aes(ymin = var - 2*dy, ymax = var + 2*dy), width = 0.2) +
ylab("Game Net Rating")
var = coeffs_and_standard_errors$travel_3_hours_back_vis
#Need to improve this with windowed distance and data with no duplicates
dy = coeffs_and_standard_errors$travel_3_hours_back_vis_se
var = coeffs_and_standard_errors$travel_3_hours_back_vis
ggplot(data = coeffs_and_standard_errors, aes(x = season, y = var)) +
geom_line(color = "blue") +
geom_point(size = 2, color = "blue") +
geom_errorbar(aes(ymin = var - 2*dy, ymax = var + 2*dy), width = 0.2) +
ylab("Game Net Rating")
pre15 <- filter(together_net_Rating_allWindows, season %in% c("2010-11","2011-12","2012-13","2013-14","2014-15"))
post15 <- filter(together_net_Rating_allWindows, season %in% c("2015-16","2016-17","2017-18","2018-19"))
summary(lm(game_net_rating ~ net_rating_diff+ three_in_four +
+ travel_3_hours_back + rest_diff,
data = pre15))
summary(lm(game_net_rating ~ net_rating_diff+ three_in_four +
+ travel_3_hours_back + rest_diff,
data = post15))
together2 <- together %>%
mutate(visitor_year = paste0(visitor, "-", season)) %>%
mutate(home_year = paste0(home, "-", season))
travel_lmer <- lmer(game_net_rating ~ g1_5_rolling_net_diff + g6_10_rolling_net_diff + g11_15_rolling_net_diff +
g16_20_rolling_net_diff + g21_25_rolling_net_diff + g26_30_rolling_net_diff +
g31_35_rolling_net_diff + g36_40_rolling_net_diff + games_played* net_rating_diff
+ rest_diff + b2b_2nd_vis + three_in_four_vis + travel_3_hours_back_vis
+ (1|visitor_year) + (1|home_year),
data = together2)
# Mixed random effects model that adds intercept terms for each team and season -------------------------
library(lme4)
together2 <- together %>%
mutate(visitor_year = paste0(visitor, "-", season)) %>%
mutate(home_year = paste0(home, "-", season))
travel_lmer <- lmer(game_net_rating ~ g1_5_rolling_net_diff + g6_10_rolling_net_diff + g11_15_rolling_net_diff +
g16_20_rolling_net_diff + g21_25_rolling_net_diff + g26_30_rolling_net_diff +
g31_35_rolling_net_diff + g36_40_rolling_net_diff + games_played* net_rating_diff
+ rest_diff + b2b_2nd_vis + three_in_four_vis + travel_3_hours_back_vis
+ (1|visitor_year) + (1|home_year),
data = together2)
View(together_net_Rating_allWindows)
#Random Effects Model
together2 <- together_net_Rating_allWindows %>%
mutate(visitor_year = paste0(visitor, "-", season)) %>%
mutate(home_year = paste0(Opponent, "-", season))
travel_lmer <- lmer(game_net_rating ~ net_rating_diff+ three_in_four +
+ travel_3_hours_back + rest_diff
+ (1|visitor_year) + (1|home_year),
data = together2)
summary(travel_lmer)
#Using just net_rating_diff
summary(lm(game_net_rating ~ net_rating_diff+ three_in_four +
+ travel_3_hours_back + rest_diff,
data = together_net_Rating_allWindows))
ranef(travel_lmer)
View(together2)
pre15 <- filter(together_net_Rating_allWindows, season %in% c("2010-11","2011-12","2012-13","2013-14","2014-15"))
post15 <- filter(together_net_Rating_allWindows, season %in% c("2015-16","2016-17","2017-18","2018-19"))
summary(lm(game_net_rating ~ net_rating_diff+ three_in_four +
+ travel_3_hours_back + rest_diff,
data = pre15))
summary(lm(game_net_rating ~ net_rating_diff+ three_in_four +
+ travel_3_hours_back + rest_diff,
data = post15))
xaringan:::inf_mr()
team_boxscores1415 <- get_team_boxscore(2014) %>%
subset(select = season_year:plus_minus) %>%
mutate(Date = substr(game_date, 0, 10)) %>%
rename(Team = team_name) %>%
select(c(Date, game_id,Team, matchup, plus_minus))
View(team_boxscores1415)
#Time of game
time2015 <- get_schedule(2015)
View(time2015)
